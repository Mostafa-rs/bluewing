{% extends 'nav.html' %}

{% block title %}
    Register Page
{% endblock %}
{% block style %}
    <style>
        .vh-110 {
            margin-top: 200px;
            margin-bottom: 200px;
        }

        div.d-flex {
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .form-outline {
            margin-bottom: 5px;
        }

        .form-outline i {
            margin-left: 5px;
        }

        .form-outline input {
            margin-bottom: 20px;
            margin-top: 5px;
            background-color: white;
            height: 50px;
            line-height: 20px;
            border-radius: 3px;
            font-weight: bold;
        }

        .form-outline input[type='text'], input[type='email'], input[type='password'] {
            color: rgb(89, 99, 126);
        }

        .form-outline {
            margin-bottom: 10px;
            padding-bottom: 20px;
            position: relative;
        }

        .form-outline label {
            display: inline-block;
            margin-bottom: 5px;
        }

        .form-outline input {
            border: 2px solid #f0f0f0;
            border-radius: 4px;
            display: block;
            font-family: inherit;
            font-size: 14px;
            padding: 10px;
            width: 100%;
        }

        .form-outline input:focus {
            outline: 0;
            border-color: #777;
        }

        .form-outline.success input {
            border-color: #2ecc71;
        }

        .form-outline.error input {
            border-color: #e74c3c;
        }

        .form-outline i.fa-check-circle {
            visibility: hidden;
            position: relative;
            right: 0;
        {#top: 30px;#}
        }

        .form-outline i.fa-exclamation-circle {
            visibility: hidden;
            position: relative;
            right: 5px;
        {#top: 40px;#}

        }

        .form-outline.success i.fa-check-circle {
            color: #2ecc71;
            visibility: visible;
        }


        .form-outline.error i.fa-exclamation-circle {
            color: #e74c3c;
            visibility: visible;
        }

        .form-outline small {
            color: #e74c3c;
            position: absolute;
            bottom: 15px;
            left: 0;
            visibility: hidden;
        }

        .form-outline.error small {
            visibility: visible;
        }


    </style>

{% endblock %}
{% block body %}



    <section class="vh-110">
        <div class="container h-custom">
            <div class="row d-flex justify-content-center align-items-center h-100">
                <div class="col-lg-12 col-xl-11">
                    <div class="text-black">
                        <div class="card-body p-md-5">
                            <div class="row justify-content-center">
                                <div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1">

                                    <p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4">ثبت نام</p>

                                    <form name="form" id="form" action=""
                                          method="post" class="mx-1 mx-md-4" novalidate>
                                        {% csrf_token %}

{#                                        {% if form.errors %}#}
{#                                            {% for f in form %}#}
{#                                            {% for e in f.errors %}#}
{#                                                <small>{{ f.label }}: {{ e|escape }}</small><br>#}
{#                                            {% endfor %}#}
{#                                            {% endfor %}#}
{#                                        {% endif %}#}

                                        <div class="d-flex flex-row align-items-center mb-4">
                                            <div class="form-outline flex-fill mb-0">
                                                <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                                                <label class="form-label" for="user_name">نام کاربری :</label>
                                                <input type="text" name="user_name" id="user_name"/>
                                                <i class="fas fa-check-circle"></i>
                                                <i class="fas fa-exclamation-circle"></i>
                                                <small>Error message</small>


                                            </div>
                                        </div>

                                        <div class="d-flex flex-row align-items-center mb-4">

                                            <div class="form-outline flex-fill mb-0">
                                                <i class="fas fa-envelope fa-lg me-3 fa-fw"></i>
                                                <label class="form-label" for="email">ایمیل :</label>
                                                <input type="email" name="email" id="email"/>
                                                <i class="fas fa-check-circle"></i>
                                                <i class="fas fa-exclamation-circle"></i>
                                                <small>Error message</small>


                                            </div>
                                        </div>

                                        <div class="d-flex flex-row align-items-center mb-4">

                                            <div class="form-outline flex-fill mb-0">
                                                <i class="fas fa-user fa-lg me-3 fa-fw"></i><label class="form-label"
                                                                                                   for="first_name">نام
                                                :</label>
                                                <input type="text" name="first_name" id="first_name"/>
                                                <i class="fas fa-check-circle"></i>
                                                <i class="fas fa-exclamation-circle"></i>
                                                <small>Error message</small>


                                            </div>
                                        </div>

                                        <div class="d-flex flex-row align-items-center mb-4">

                                            <div class="form-outline flex-fill mb-0">
                                                <i class="fas fa-user fa-lg me-3 fa-fw"></i><label class="form-label"
                                                                                                   for="last_name">نام
                                                خانوادگی :</label>
                                                <input type="text" name="last_name" id="last_name"/>
                                                <i class="fas fa-check-circle"></i>
                                                <i class="fas fa-exclamation-circle"></i>
                                                <small>Error message</small>


                                            </div>
                                        </div>

                                        <div class="d-flex flex-row align-items-center mb-4">

                                            <div class="form-outline flex-fill mb-0">
                                                <i class="fas fa-lock fa-lg me-3 fa-fw"></i><label class="form-label"
                                                                                                   for="password_1">رمز
                                                عبور :</label>
                                                <input type="password" name="password_1" id="password_1"/>
                                                <i class="fas fa-check-circle"></i>
                                                <i class="fas fa-exclamation-circle"></i>
                                                <small>Error message</small>


                                            </div>
                                        </div>

                                        <div class="d-flex flex-row align-items-center mb-4">

                                            <div class="form-outline flex-fill mb-0">
                                                <i class="fas fa-key fa-lg me-3 fa-fw"></i><label class="form-label"
                                                                                                  for="password_2">تکرار
                                                رمز عبور :</label>
                                                <input type="password" name="password_2" id="password_2"/>
                                                <i class="fas fa-check-circle"></i>
                                                <i class="fas fa-exclamation-circle"></i>
                                                <small>Error message</small>



                                            </div>

                                        </div>


                                        <div class="d-flex justify-content-center mx-4 mb-3 mb-lg-4">
                                            <button type="submit" name="register-submition"
                                                    class="btn btn-primary btn-lg">ثبت نام
                                            </button>
                                        </div>


                                    </form>

                                </div>
                                <div class="col-md-10 col-lg-6 col-xl-7 d-flex align-items-center order-1 order-lg-2">

                                    <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-registration/draw1.webp"
                                         class="img-fluid" alt="Sample image">

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script>
        const form = document.getElementById('form');
        const username = document.getElementById('user_name');
        const firstname = document.getElementById('first_name');
        const lastname = document.getElementById('last_name');
        const email = document.getElementById('email');
        const password = document.getElementById('password_1');
        const password2 = document.getElementById('password_2');
        const regex_all = /[a-zA-Z]/
        const regex_upper = /[A-Z]/
        let check_u = ''
        let check_f = ''
        let check_l = ''
        let check_e = ''
        let check_p = ''
        let check_p2 = ''

        form.addEventListener('submit', e => {
            e.preventDefault();

            checkInputs();
              });

        function checkInputs() {
            // trim to remove the whitespaces
            const usernameValue = username.value.trim();
            const firstnameValue = firstname.value.trim();
            const lastnameValue = lastname.value.trim();
            const emailValue = email.value.trim();
            const passwordValue = password.value.trim();
            const password2Value = password2.value.trim();

            if (usernameValue === '') {
                setErrorFor(username, 'نام کاربری را کامل کنید');
            } else {
                setSuccessFor(username);
                check_u = 's'
            }

            if (firstnameValue === '') {
                setErrorFor(firstname, 'اسم خود را بنویسید');
            } else {
                setSuccessFor(firstname);
                check_f = 's'
            }

            if (lastnameValue === '') {
                setErrorFor(lastname, 'نام خانوادگی خود را بنویسید');
            } else {
                setSuccessFor(lastname);
                check_l = 's'
            }

            if (emailValue === '') {
                setErrorFor(email, 'ایمیل خود را بنویسید');
            } else if (!isEmail(emailValue)) {
                setErrorFor(email, 'ایمیل معتبر نیست');
            } else {
                setSuccessFor(email);
                check_e = 's'
            }

            if (passwordValue === '') {
                setErrorFor(password, 'رمز عبور را وارد کنید');
            } else {
                setSuccessFor(password);
                check_p = 's'
            }

            if (password2Value === '') {
                setErrorFor(password2, 'تکرار رمز عبور را وارد کنید');
            } else if (passwordValue !== password2Value) {
                setErrorFor(password2, 'رمز عبور با هم مطابقت ندارند!');
                setErrorFor(password, '')
            }else if (password2Value.length < 8) {
                setErrorFor(password2, 'رمز عبور نباید کمتر از 8 حرف باشد')
                setErrorFor(password, '')
            }else if (!regex_all.test(password2Value) || !regex_upper.test(password2Value)) {
                setErrorFor(password2, 'رمز عبور باید شامل حروف کوچک و بزرگ و اعداد باشد')
                setErrorFor(password, '')
            } else {
                setSuccessFor(password2);
                check_p2 = 's'
            }

            if (check_u === 's' && check_f === 's' && check_l === 's' && check_e === 's' && check_p === 's' && check_p2 === 's'){
            form.submit()
        }
        }

        function setErrorFor(input, message) {
            const formOutline = input.parentElement;
            const small = formOutline.querySelector('small');
            formOutline.className = "form-outline error";
            small.innerText = message;
        }

        function setSuccessFor(input) {
            const formOutline = input.parentElement;
            formOutline.className = 'form-outline success';
        }

        function isEmail(email) {
            return /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(email);
        }

    </script>






{% endblock %}